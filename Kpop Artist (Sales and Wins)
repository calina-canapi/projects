--USING 2 SETS OF FILES (ARTIST INFO AND VIDEO INFO), I IDENTIFIED THE HIGHEST SELLING CURRENT KPOP ARTIST ALONG WITH MOST AWARDED KPOP ARTISTS. I THEN EXPLORED THE TOTAL WINS AND SALES PER GENDER --  
--------------------
"Sales Per Artist"

-- This query breaks down Sales per Artist/Group using CTE --

WITH Sales_per_artist AS
(SELECT Artist_info.korean_artists_id, sales,Artist_info.name
FROM [Kpop].[dbo].[Artist info] AS Artist_info
INNER JOIN [Kpop].[dbo].[Video info] AS Video_info
ON Artist_info.korean_artists_id = Video_info.korean_artists_id
)

SELECT sales,name
FROM Sales_per_artist
GROUP BY sales, name
ORDER BY sales DESC;
--------------------

"Awards Per Artist" 

-- This query breaks down Award show wins per Artist/Group using CTE --

WITH Awards_won AS
(SELECT Artist_info.korean_artists_id, music_show_awards,yearly_awards,Artist_info.name
FROM [Kpop].[dbo].[Artist info] AS Artist_info
INNER JOIN [Kpop].[dbo].[Video info] AS Video_info
ON Artist_info.korean_artists_id = Video_info.korean_artists_id)

SELECT name, (SUM(music_show_awards) + SUM(yearly_awards)) AS Wins
FROM Awards_won
GROUP BY name
ORDER BY Wins DESC;
--------------------

"Totals Per Gender"

-- This query identifies the Total Sales and Wins per gender. It also includes the pecentage per gender in each category using Window Functions --

SELECT Artist_info.gender AS Gender,

-- Calculate Total Wins --
(SUM(music_show_awards) + SUM(yearly_awards)) AS TotalWins,

--Calculate Total Sales --
		SUM(CAST(Artist_info.sales AS BIGINT)) AS TotalSales,

-- % of Total Win--
100 * (SUM(music_show_awards) + SUM(yearly_awards))/SUM((SUM(music_show_awards) + SUM(yearly_awards))) OVER () AS PctWins,

-- % of Total Sales--
100.0 * SUM(CAST(Artist_info.sales AS BIGINT))/SUM(SUM(CAST(Artist_info.sales AS BIGINT))) OVER () AS PctSales

FROM [Kpop].[dbo].[Artist info] AS Artist_info
INNER JOIN [Kpop].[dbo].[Video info] AS Video_info
ON Artist_info.korean_artists_id = Video_info.korean_artists_id
WHERE Gender IN ('Male','Female')
GROUP BY Gender;

"Determining Active Groups"

-- This query determines information on active/disbanded groups --

WITH Artists_table AS (
	SELECT Artist_info.korean_artists_id, sales,Artist_info.name, Artist_info.gender, Artist_info.solo_or_group, Artist_info.disband_date
	FROM [Kpop].[dbo].[Artist info] AS Artist_info
	INNER JOIN [Kpop].[dbo].[Video info] AS Video_info
	ON Artist_info.korean_artists_id = Video_info.korean_artists_id
	 )


SELECT name, korean_artists_id,disband_date,

--  Creating a case to determine if groups are still active or inactive -- 
CASE
	WHEN disband_date IS NULL THEN 'Active'
	ELSE 'Disbanded'
	END AS Active_Status

FROM Artists_table
ORDER BY disband_date ASC;
--------------------

"Debuts Per Generation"

--- Identifies how many artists debuted under which Kpop Generation ---

SELECT 
    Generation,
    COUNT(*) AS Debuted_Artists_Count
FROM (
    SELECT 
        CASE
            WHEN debut_date BETWEEN '1992-04-11' AND '2003-12-25' THEN 'First Gen'
            WHEN debut_date BETWEEN '2003-12-26' AND '2012-04-07' THEN 'Second Gen'
            WHEN debut_date BETWEEN '2012-04-08' AND '2017-12-30' THEN 'Third Gen'
            WHEN debut_date BETWEEN '2017-12-31' AND '2023-01-07' THEN 'Fourth Gen'
            WHEN debut_date >= '2023-01-08' THEN 'Fifth Gen'
            ELSE 'Unknown'
        END AS Generation
    FROM [Kpop].[dbo].[Artist info]
    
) g
GROUP BY Generation
ORDER BY 
    CASE Generation
        WHEN 'First Gen' THEN 1
        WHEN 'Second Gen' THEN 2
        WHEN 'Third Gen' THEN 3
        WHEN 'Fourth Gen' THEN 4
        WHEN 'Fifth Gen' THEN 5
        ELSE 6
    END;
--------------------

